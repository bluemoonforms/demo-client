{% extends "layout.html" %}
{% block title %}Integration Details{% endblock %}

{% block css %}
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
{% endblock %}

{% block body %}
<div class="mui--appbar-height"></div>
<br>
<br>
<div class="mui-container">
   <div class="mui--text-title"">Implementing Bluemoon Forms Lease Application</div>
   <div class="mui--text-subhead">Include the Bluemoon CSS and Material Design Icon files:</div>
   <pre><code class="html">{%- for css_file in context.css_files %}
&lt;link href=&quot;//{{context.static_url}}/{{css_file}}&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;/&gt;
    {%- endfor %}&lt;link href=&quot;//fonts.googleapis.com/icon?family=Material+Icons&quot; rel=&quot;stylesheet&quot;/&gt;</code></pre>
   <div class="mui--text-subhead">Add the base container where you want the code to display:</div>
   <pre><code class="html">&lt;div class=&quot;blueMoon&quot;&gt;&lt;app-root&gt;&lt;/app-root&gt;&lt;/div&gt;</code></pre>
   <div class="mui--text-subhead">Implement the integration configuration:</div>
   <pre><code class="html">&lt;script type=&quot;text/javascript&quot;&gt;
window.BLUEMOON_CONFIG = {{ context.configuration|tojson_pretty|safe }};
&lt;/script&gt;</code></pre>
   <div class="mui--text-subhead">Finally include the JS files:</div>
   <pre><code class="html">{% for js_file in context.js_files %}
&lt;script type=&quot;text/javascript&quot; src=&quot;//{{context.static_url}}/{{js_file}}&quot;&gt;&lt;/script&gt;
{%- endfor %}</code></pre>
</div>
<div class="mui-container">
   <div class="mui--text-title"mui--text-display1">Optional integration details</div>
   <div class="mui--text-subhead">Parameters</div>
   <table class="mui-table mui-table--bordered">
      <thead>
         <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
         </tr>
      </thead>
      <tbody>
         <tr>
            <td>apiUrl</td>
            <td>string</td>
            <td>URL for API</td>
         </tr>
         <tr>
            <td>propertyNumber</td>
            <td>number</td>
            <td>Property Number for Leases</td>
         </tr>
         <tr>
            <td>accessToken</td>
            <td>string</td>
            <td>Oauth Token for User</td>
         </tr>
         <tr>
            <td>navigation</td>
            <td>boolean</td>
            <td>use navgiation or not</td>
         </tr>
         <tr>
            <td>view</td>
            <td>string</td>
            <td>'create', 'edit' or null</td>
         </tr>
         <tr>
            <td>callBack</td>
            <td>string: URL on your system that will accept a JSON post of the lease data</td>
         </tr>
         <tr>
            <td>leaseData</td>
            <td>object</td>
            <td>Data to prepoulate the lease object with.</td>
         </tr>
         <tr>
            <td>origin</td>
            <td>string</td>
            <td>client specific values, please ask Bluemoon</td>
         </tr>
         <tr>
            <td>lockPopulatedFields</td>
            <td>boolean</td>
            <td>lock fields poplulated with data from leaseData</td>
         </tr>
         <tr>
            <td>disableFieldToolTips</td>
            <td>boolean</td>
            <td>disable field tool tips that display field names</td>
         </tr>
      </tbody>
   </table>
   <div class="mui--text-subhead">Create Lease</div>
   <pre><code class="html">&lt;script type=&quot;text/javascript&quot;&gt;
window.BLUEMOON_CONFIG = {{ context.create_view|tojson_pretty|safe }};
&lt;/script&gt;</code></pre>
   <div class="mui--text-subhead">Edit Lease</div>
   <pre><code class="html">&lt;script type=&quot;text/javascript&quot;&gt;
window.BLUEMOON_CONFIG = {{ context.edit_view|tojson_pretty|safe }};
&lt;/script&gt;</code></pre>
   <div class="mui--text-subhead">Lease Data</div>
   <pre><code class="json">
{
   "lease_id":"34973569",
   "data":{
      "standard":{
         "address":"Main St.",
         "date_of_lease":"07\/13\/2017",
         "lease_begin_date":"07\/13\/2017",
         "lease_end_date":"09\/01\/2018",
         "maximum_guest_stay":null,
         "occupant_1":null,
         "occupant_2":null,
         "occupant_3":null,
         "occupant_4":null,
         "prorated_rent":"100.00",
         "prorated_rent_due_date":null,
         "prorated_rent_due_first_month":null,
         "rent":"100.00",
         "resident_1":"John Doe",
         "resident_2":null,
         "resident_3":null,
         "resident_4":null,
         "security_deposit":"10.00",
         "unit_number":"123",
         "days_required_for_notice_of_lease_termination":null,
         "late_charge_initial_charge":null,
         "number_of_apartment_keys":null,
         "number_of_mail_keys":null,
         "number_of_other_keys":null,
         "other_key_type":null,
         "rent_due_date":null,
         "renters_insurance_requirement":null,
         "utilities_cable_tv":"T",
         "utilities_electricity":"T",
         "utilities_gas":"T",
         "utilities_master_antenna":"T",
         "utilities_other":"T",
         "utilities_other_description":null,
         "utilities_trash":"T",
         "utilities_wastewater":"T",
         "utilities_water":"T",
         "acceptable_forms_of_payment":null,
         "lease_terminates_last_day_of_month":null,
         "owners_agent_address":null,
         "owners_agent_city_state_zip":null,
         "owners_agent_name":null,
         "owners_agent_telephone":null,
         "pay_rent_address":null,
         "pay_rent_at_online_site":"T",
         "pay_rent_at_other_location":"T",
         "pay_rent_on_site":"T",
         "payment_recipient_address":null,
         "payment_recipient_availability":null,
         "payment_recipient_city_state_zip":null,
         "payment_recipient_name":null,
         "payment_recipient_telephone":null,
         "personal_payments_policy":null,
         "special_provisions":null,
         "unit_furnished":null,
         "addendum_access_gate":"T",
         "addendum_animal_addendum":"T",
         "addendum_apartment_rules":"T",
         "addendum_asbestos":"T",
         "addendum_code_access":"T",
         "addendum_code_access_date":null,
         "addendum_early_termination":"T",
         "addendum_enclosed_garage":"T",
         "addendum_intrusion_alarm":"T",
         "addendum_inventory_and_condition":"T",
         "addendum_lead_hazard_disclosure":"T",
         "addendum_lease_contract_guaranty":"T",
         "addendum_lease_contract_guaranty_number":null,
         "addendum_mold":"T",
         "addendum_notice_of_intent_to_move_out":"T",
         "addendum_other1":"T",
         "addendum_other1_description":null,
         "addendum_other2":"T",
         "addendum_other2_description":null,
         "addendum_parking_permit":"T",
         "addendum_parking_permit_quantity":null,
         "addendum_satellite_dish":"T",
         "addendum_utility_allocation":"T",
         "locator_address":null,
         "locator_city_state_zip":null,
         "locator_name":null,
         "owners_representative_address_1":null,
         "owners_representative_address_2":null,
         "owners_representative_fax":null,
         "owners_representative_telephone":null,
         "pet_2_age":null,
         "pet_2_breed":null,
         "pet_2_color":null,
         "pet_2_date_of_last_shots":null,
         "pet_2_house_broken":null,
         "pet_2_license_city":null,
         "pet_2_license_number":null,
         "pet_2_name":null,
         "pet_2_owners_name":null,
         "pet_2_type":null,
         "pet_2_weight":null,
         "pet_additional_rent":null,
         "pet_age":null,
         "pet_breed":null,
         "pet_color":null,
         "pet_date_of_last_shots":null,
         "pet_dr_address":null,
         "pet_dr_city":null,
         "pet_dr_name":null,
         "pet_dr_telephone":null,
         "pet_house_broken":null,
         "pet_license_city":null,
         "pet_license_number":null,
         "pet_name":null,
         "pet_owners_name":null,
         "pet_special_provisions":null,
         "pet_type":null,
         "pet_urinate_inside_areas":null,
         "pet_urinate_outside_areas":null,
         "pet_weight":null,
         "security_deposit_includes_add_pet_rent":null,
         "lead_based_paint_knowledge":null,
         "lead_based_paint_knowledge_comments":null,
         "lead_based_paint_reports":null,
         "lead_based_paint_reports_comments":null,
         "bed_bug_addendum_infestation":null,
         "bed_bug_addendum_infestation_disclosure":null,
         "bed_bug_addendum_inspection":null,
         "early_termination_days_written_notice":null,
         "early_termination_fee":null,
         "early_termination_fee_due_days_before_termination":null,
         "early_termination_last_day_of_month":null,
         "early_termination_limited_to_fact":null,
         "early_termination_special_provisions":null,
         "early_termination_total_fee":null,
         "garage_addendum_carport_provided":"T",
         "garage_addendum_carport_space_no":null,
         "garage_addendum_garage_key":"T",
         "garage_addendum_garage_opener":"T",
         "garage_addendum_garage_or_carport_provided":"T",
         "garage_addendum_garage_provided":"T",
         "garage_addendum_garage_space_no":null,
         "garage_addendum_opener_will_be_provided":null,
         "garage_addendum_special_provisions":null,
         "garage_addendum_storage_unit_no":null,
         "garage_addendum_storage_unit_provided":"T",
         "lease_guaranty_special_provisions":null,
         "no_smoking_addendum_smoking_areas":null,
         "no_smoking_addendum_smoking_policy":null,
         "parking_space_no":null,
         "parking_space_provided":"T",
         "san_francisco_smoking_status":null,
         "satellite_addendum_deposit_scope":null,
         "satellite_addendum_insurance":null,
         "satellite_addendum_no_dishes":null,
         "satellite_addendum_security_deposit":null,
         "satellite_addendum_special_provisions":null,
         "security_deposit_includes_satellite_dep":null,
         "storage_monthly_charge":null,
         "storage_space_no":null,
         "storage_space_provided":"T",
         "subletting_prohibited":"T",
         "utility_addendum_administration_fee":null,
         "utility_addendum_billing_fee_limit":null,
         "utility_addendum_cable_tv_billing_co":"T",
         "utility_addendum_cable_tv_billing_co_desc":null,
         "utility_addendum_cable_tv_flat_rate_selected":"T",
         "utility_addendum_cable_tv_formula":null,
         "utility_addendum_cable_tv_paid_by":null,
         "utility_addendum_cable_tv_rate":null,
         "utility_addendum_days_to_pay_bill":null,
         "utility_addendum_electric_billing_co":"T",
         "utility_addendum_electric_billing_co_desc":null,
         "utility_addendum_electric_flat_rate_selected":"T",
         "utility_addendum_electric_formula":null,
         "utility_addendum_electric_paid_by":null,
         "utility_addendum_electric_rate":null,
         "utility_addendum_final_bill_fee":null,
         "utility_addendum_final_bill_fee_limit":null,
         "utility_addendum_gas_billing_co":"T",
         "utility_addendum_gas_billing_co_desc":null,
         "utility_addendum_gas_flat_rate_selected":"T",
         "utility_addendum_gas_formula":null,
         "utility_addendum_gas_paid_by":null,
         "utility_addendum_gas_rate":null,
         "utility_addendum_internet_billing_co":"T",
         "utility_addendum_internet_billing_co_desc":null,
         "utility_addendum_internet_flat_rate_selected":"T",
         "utility_addendum_internet_formula":null,
         "utility_addendum_internet_paid_by":null,
         "utility_addendum_internet_rate":null,
         "utility_addendum_late_fee":null,
         "utility_addendum_late_fee_limit":null,
         "utility_addendum_master_antenna_billing_co":"T",
         "utility_addendum_master_antenna_billing_co_desc":null,
         "utility_addendum_master_antenna_flat_rate_selected":"T",
         "utility_addendum_master_antenna_formula":null,
         "utility_addendum_master_antenna_paid_by":null,
         "utility_addendum_master_antenna_rate":null,
         "utility_addendum_other":null,
         "utility_addendum_other_2":null,
         "utility_addendum_other_billing_co":"T",
         "utility_addendum_other_billing_co_2":"T",
         "utility_addendum_other_billing_co_desc":null,
         "utility_addendum_other_billing_co_desc_2":null,
         "utility_addendum_other_billing_fee":null,
         "utility_addendum_other_flat_rate_selected":"T",
         "utility_addendum_other_flat_rate_selected_2":"T",
         "utility_addendum_other_formula":null,
         "utility_addendum_other_formula_2":null,
         "utility_addendum_other_paid_by":null,
         "utility_addendum_other_paid_by_2":null,
         "utility_addendum_other_rate":null,
         "utility_addendum_other_rate_2":null,
         "utility_addendum_set_up_fee":null,
         "utility_addendum_set_up_fee_limit":null,
         "utility_addendum_sewer_billing_co":"T",
         "utility_addendum_sewer_billing_co_desc":null,
         "utility_addendum_sewer_flat_rate_selected":"T",
         "utility_addendum_sewer_formula":null,
         "utility_addendum_sewer_paid_by":null,
         "utility_addendum_sewer_rate":null,
         "utility_addendum_special_provisions":null,
         "utility_addendum_stormwater_billing_co":"T",
         "utility_addendum_stormwater_billing_co_desc":null,
         "utility_addendum_stormwater_flat_rate_selected":"T",
         "utility_addendum_stormwater_formula":null,
         "utility_addendum_stormwater_paid_by":null,
         "utility_addendum_stormwater_rate":null,
         "utility_addendum_trash_billing_co":"T",
         "utility_addendum_trash_billing_co_desc":null,
         "utility_addendum_trash_flat_rate_selected":"T",
         "utility_addendum_trash_formula":null,
         "utility_addendum_trash_paid_by":null,
         "utility_addendum_trash_rate":null,
         "utility_addendum_water_billing_co":"T",
         "utility_addendum_water_billing_co_desc":null,
         "utility_addendum_water_flat_rate_selected":"T",
         "utility_addendum_water_formula":null,
         "utility_addendum_water_paid_by":null,
         "utility_addendum_water_rate":null,
         "parking_begin_date":null,
         "parking_due_date":null,
         "parking_end_date":null,
         "parking_monthly_charge":null,
         "parking_monthly_charge_date":null,
         "parking_nsf_fee":null,
         "parking_one_time_date":null,
         "parking_one_time_fee":null,
         "parking_space_number_1":null,
         "parking_space_number_2":null,
         "parking_space_number_3":null,
         "parking_special_provisions":null,
         "vehicle_license_number_1":null,
         "vehicle_license_number_2":null,
         "vehicle_license_number_3":null,
         "vehicle_make_1":null,
         "vehicle_make_2":null,
         "vehicle_make_3":null,
         "vehicle_model_year_1":null,
         "vehicle_model_year_2":null,
         "vehicle_model_year_3":null,
         "vehicle_owner_number_1":null,
         "vehicle_owner_number_2":null,
         "vehicle_owner_number_3":null,
         "vehicle_permit_number_1":null,
         "vehicle_permit_number_2":null,
         "vehicle_permit_number_3":null,
         "vehicle_state_1":null,
         "vehicle_state_2":null,
         "vehicle_state_3":null,
         "community_business_center_availability":null,
         "community_business_center_computer_time_limit":null,
         "community_extermination_pest_control":null,
         "community_fire_hazards_grill_distance":null,
         "community_fitness_center_availability":null,
         "community_fitness_center_card_1":null,
         "community_fitness_center_card_2":null,
         "community_fitness_center_card_3":null,
         "community_fitness_center_card_4":null,
         "community_package_release_policy":null,
         "community_policies_special_provisions":null,
         "community_pool_availability":null,
         "community_vehicles_maximum_allowed":null,
         "community_vehicles_towing_notice":null,
         "addendum_rent_concession_amount":null,
         "addendum_rent_concession_description":null,
         "addendum_rent_concession_monthly_discount":"T",
         "addendum_rent_concession_one_time":"T",
         "addendum_rent_concession_one_time_amount":null,
         "addendum_rent_concession_one_time_months":null,
         "addendum_rent_concession_other_discount":"T",
         "addendum_rent_concession_special_provisions":null,
         "renters_insurance_liability_limit":null,
         "renters_insurance_minimum_coverage":null,
         "renters_insurance_provider":null,
         "renters_insurance_special_provisions":null,
         "alarm_addendum_special_provisions":null,
         "alarm_company_required_to_activate":null,
         "alarm_instructions_attached":null,
         "alarm_maintainer":null,
         "alarm_permit_activation_phone":null,
         "alarm_permit_required_to_activate":null,
         "alarm_repair_contact":null,
         "alarm_repairs_paid_by":null,
         "alarm_required":null,
         "alarm_required_company":null,
         "alarm_resident_chooses_company":null,
         "remote_card_code_addendum_card":"T",
         "remote_card_code_addendum_code":"T",
         "remote_card_code_addendum_code_change":"T",
         "remote_card_code_addendum_lost_card":"T",
         "remote_card_code_addendum_lost_card_deduct":null,
         "remote_card_code_addendum_lost_remote":"T",
         "remote_card_code_addendum_lost_remote_deduct":null,
         "remote_card_code_addendum_remote":"T",
         "remote_card_code_addendum_replace_card_fee":null,
         "remote_card_code_addendum_replace_remote_fee":null,
         "remote_card_code_special_provisions":null,
         "additional_special_provisions":null,
         "affordable_housing_special_provisions":null,
         "airbnb_special_provisions":null,
         "asbestos_addendum_special_provisions":null,
         "mold_addendum_special_provisions":null
      }
   }
}
    </code></pre>
</div>
<div class="mui-container">
    <div class="mui--text-title"">OAuth2 Password Grant</div>
    <div class="mui--text-subhead">Python</div>
    <pre><code class="python">
import requests

def login(username, license, password):
    headers = {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
        'Provider': 'legacy'
    }
    url = '{}/oauth/token'.format(os.getenv('OAUTH_CLIENT_URL'))
    payload = {
        'username': username,
        'password': password,
        'license': license,
        'grant_type': 'password',
        'client_id': os.getenv('OAUTH_CLIENT_ID'),
        'client_secret': os.getenv('OAUTH_CLIENT_SECRET')
    }
    response = requests.post(url, headers=headers, json=payload)
    data = response.json()
    if response.status_code == 200:
        return data['access_token']
    </code></pre>
    <div class="mui--text-subhead">PHP</div>
    <pre><code class="php">
use GuzzleHttp\Client;

function login($username, $license, $password)
{
    $client = new Client(['base_uri' => env('OAUTH_CLIENT_URL')]);
    $headers = [
        'Accept' => 'application/json',
        'Content-Type' => 'application/json',
        'Provider' => 'legacy'
    ];
    $data = [
        'username' => $username,
        'password' => $password,
        'license' => $license,
        'grant_type' => 'password',
        'client_id' => env('OAUTH_CLIENT_ID'),
        'client_secret' => env('OAUTH_CLIENT_SECRET'),
    ];
    $response = $client->post('/oauth/token', [
        'headers' => $headers(),
        'http_errors' => false,
        'json' => $data
    ]);
    $statusCode = $response->getStatusCode();
    $data = json_decode($response->getBody(), true);
    if ($statusCode == 200) {
        return $data['access_token'];
    }
}
    </code></pre>
    <div class="mui--text-subhead">curl</div>
    <pre><code class="bash">
curl -X POST \
  $OAUTH_CLIENT_URL/oauth/token \
  -H 'Cache-Control: no-cache' \
  -H 'Content-Type: application/json' \
  -H 'Provider: legacy' \
  -d '{
    "username": "$USERNAME",
    "password": "$PASSWORD",
    "license": "$LICENSE",
    "grant_type": "password",
    "client_id": $OAUTH_CLIENT_ID,
    "client_secret": "$OAUTH_CLIENT_SECRET"
}'
    </code></pre>
</div>
{% endblock %}

{% block scripts %}
<script>hljs.initHighlightingOnLoad();</script>
{% endblock %}